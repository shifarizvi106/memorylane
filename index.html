<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Memory Lane</title>
<style>
:root{
  --primary:#8B5CF6;
  --accent:#EC4899;
  --bg:#f8f9fa;
  --card:#fff;
  --text:#1e293b;
  --muted:#64748b;
  --shadow:0 8px 20px rgba(0,0,0,0.1);
  --radius:12px;
}
body.dark{
  --bg:#121212;
  --card:#1e1e1e;
  --text:#f3f3f3;
  --muted:#a0a0a0;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:'Inter',sans-serif;
  background:var(--bg);
  color:var(--text);
  transition:0.3s;
}
.container{
  max-width:1200px;
  margin:0 auto;
  padding:20px;
}
/* Header */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px;
  background:var(--card);
  box-shadow:var(--shadow);
  border-radius:var(--radius);
  margin-bottom:20px;
}
header h1{
  font-size:1.8rem;
  background:linear-gradient(135deg,#8B5CF6,#EC4899);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.dark-toggle{
  cursor:pointer;
  padding:6px 12px;
  border:none;
  border-radius:8px;
  background:var(--primary);
  color:white;
  font-weight:600;
}
/* Login */
#loginArea{
  display:flex;
  flex-direction:column;
  gap:12px;
  max-width:300px;
  margin:100px auto;
  background:var(--card);
  padding:20px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
#loginArea input, #loginArea button{
  padding:10px;
  border-radius:8px;
  border:1px solid var(--muted);
}
#loginArea button{
  background:var(--primary);
  color:white;
  border:none;
  cursor:pointer;
  font-weight:600;
}
#dashboard{display:none;}
.profile-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}
.profile-header h2{font-size:1.5rem;}
.btn{padding:6px 12px;border:none;border-radius:8px;cursor:pointer;font-weight:600;}
.btn-primary{background:var(--primary);color:white;}
.btn-danger{background:red;color:white;}
.posts-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:20px;
}
.post-card{
  background:var(--card);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:10px;
  display:flex;
  flex-direction:column;
  gap:8px;
}
.post-card img{
  width:100%;
  border-radius:var(--radius);
  cursor:pointer;
}
.post-caption{font-size:0.9rem;color:var(--text);}
.post-date{font-size:0.8rem;color:var(--muted);}
.post-actions{display:flex;justify-content:space-between;align-items:center;}
.comment-input{width:100%;padding:6px;border-radius:8px;border:1px solid var(--muted);}
.comments{font-size:0.8rem;color:var(--muted);}
.upload-section{
  margin-bottom:20px;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.user-list{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-bottom:20px;
}
.user-btn{
  padding:6px 12px;
  border-radius:8px;
  cursor:pointer;
  background:var(--primary);
  color:white;
}
</style>
</head>
<body>
<header>
  <h1>Memory Lane</h1>
  <button class="dark-toggle">ðŸŒ“</button>
</header>

<div id="loginArea">
  <h3>Login</h3>
  <input type="text" id="username" placeholder="Username">
  <input type="text" id="password" placeholder="Birthday (DD/MM/YYYY)">
  <button id="loginBtn">Login</button>
  <p id="loginError" style="color:red;font-size:0.9rem;"></p>
</div>

<div id="dashboard" class="container">
  <div class="profile-header">
    <h2 id="profileName"></h2>
    <button id="logoutBtn" class="btn btn-danger">Logout</button>
  </div>

  <div class="user-list" id="userList">
    <!-- Friends buttons to visit -->
  </div>

  <div class="upload-section">
    <input type="file" id="imageUpload">
    <input type="text" id="captionInput" placeholder="Caption">
    <input type="date" id="memoryDate">
    <button id="uploadBtn" class="btn btn-primary">Upload</button>
  </div>

  <div class="posts-grid" id="postsGrid">
    <!-- Posts appear here -->
  </div>
</div>

<script>
// Users
const users = [
  {name:"Ritika",birthday:"06/07/2008"},
  {name:"Vidhi",birthday:"12/11/2008"},
  {name:"Saksham",birthday:"24/01/2009"},
  {name:"Harshit",birthday:"23/01/2007"},
  {name:"Sai",birthday:"04/03/2008"},
  {name:"Juili",birthday:"25/05/2008"},
  {name:"Kunal",birthday:"19/10/2008"},
  {name:"Ayaan",birthday:"16/01/2008"},
  {name:"Amrut",birthday:"20/09/2005"},
  {name:"Shifa",birthday:"10/06/2008"}
];

// State
let currentUser=null;
let viewingUser=null;
let posts=[]; // {user,image,caption,date,likes[],comments[]}

// Load posts from localStorage
if(localStorage.getItem('posts')){
  posts=JSON.parse(localStorage.getItem('posts'));
}

// Elements
const loginArea=document.getElementById('loginArea');
const dashboard=document.getElementById('dashboard');
const loginBtn=document.getElementById('loginBtn');
const logoutBtn=document.getElementById('logoutBtn');
const usernameInput=document.getElementById('username');
const passwordInput=document.getElementById('password');
const loginError=document.getElementById('loginError');
const profileName=document.getElementById('profileName');
const userList=document.getElementById('userList');
const postsGrid=document.getElementById('postsGrid');
const imageUpload=document.getElementById('imageUpload');
const captionInput=document.getElementById('captionInput');
const memoryDate=document.getElementById('memoryDate');
const uploadBtn=document.getElementById('uploadBtn');
const darkToggle=document.querySelector('.dark-toggle');

// Dark Mode
darkToggle.onclick=()=>document.body.classList.toggle('dark');

// Login
loginBtn.onclick=()=>{
  const uname=usernameInput.value.trim();
  const pwd=passwordInput.value.trim();
  const user=users.find(u=>u.name.toLowerCase()===uname.toLowerCase() && u.birthday===pwd);
  if(user){
    currentUser=user;
    viewingUser=user;
    loginArea.style.display='none';
    dashboard.style.display='block';
    renderDashboard();
    loginError.textContent='';
  }else{
    loginError.textContent='Invalid username or birthday';
  }
};

// Logout
logoutBtn.onclick=()=>{
  currentUser=null;
  viewingUser=null;
  dashboard.style.display='none';
  loginArea.style.display='block';
};

// Render Dashboard
function renderDashboard(){
  profileName.textContent=viewingUser.name+"'s Profile";
  // Friends buttons
  userList.innerHTML='';
  users.forEach(u=>{
    if(u.name!==currentUser.name){
      const btn=document.createElement('button');
      btn.textContent=u.name;
      btn.className='user-btn';
      btn.onclick=()=>{viewingUser=u;renderDashboard();}
      userList.appendChild(btn);
    }
  });
  renderPosts();
}

// Render Posts
function renderPosts(){
  postsGrid.innerHTML='';
  const userPosts=posts.filter(p=>p.user===viewingUser.name);
  if(userPosts.length===0){
    postsGrid.innerHTML='<p>No posts yet.</p>';
    return;
  }
  userPosts.forEach((p,i)=>{
    const card=document.createElement('div');
    card.className='post-card';
    const img=document.createElement('img');
    img.src=p.image;
    img.onclick=()=>window.open(p.image,'_blank');
    const caption=document.createElement('div');
    caption.className='post-caption';
    caption.textContent=p.caption;
    const dateDiv=document.createElement('div');
    dateDiv.className='post-date';
    dateDiv.textContent=p.memoryDate;
    const actions=document.createElement('div');
    actions.className='post-actions';
    
    // Likes
    const likeBtn=document.createElement('button');
    likeBtn.textContent=`â¤ï¸ ${p.likes.length}`;
    likeBtn.className='btn btn-primary';
    likeBtn.onclick=()=>{
      if(!p.likes.includes(currentUser.name)) p.likes.push(currentUser.name);
      else p.likes=p.likes.filter(l=>l!==currentUser.name);
      savePosts();
      renderPosts();
    };
    
    // Delete if owner
    let delBtn=null;
    if(p.user===currentUser.name){
      delBtn=document.createElement('button');
      delBtn.textContent='Delete';
      delBtn.className='btn btn-danger';
      delBtn.onclick=()=>{
        if(confirm('Delete this post?')){
          posts.splice(posts.indexOf(p),1);
          savePosts();
          renderPosts();
        }
      };
    }
    
    // Comments
    const commentDiv=document.createElement('div');
    commentDiv.className='comments';
    p.comments.forEach(c=>{
      const cDiv=document.createElement('div');
      cDiv.textContent=`${c.user}: ${c.text}`;
      commentDiv.appendChild(cDiv);
    });
    const commentInput=document.createElement('input');
    commentInput.placeholder='Comment...';
    commentInput.className='comment-input';
    commentInput.onkeypress=(e)=>{
      if(e.key==='Enter' && commentInput.value.trim()!==''){
        p.comments.push({user:currentUser.name,text:commentInput.value.trim()});
        commentInput.value='';
        savePosts();
        renderPosts();
      }
    };
    
    actions.appendChild(likeBtn);
    if(delBtn) actions.appendChild(delBtn);
    
    card.appendChild(img);
    card.appendChild(caption);
    card.appendChild(dateDiv);
    card.appendChild(actions);
    card.appendChild(commentDiv);
    card.appendChild(commentInput);
    postsGrid.appendChild(card);
  });
}

// Upload
uploadBtn.onclick=async()=>{
  if(!imageUpload.files[0]) return alert('Select an image');
  const file=imageUpload.files[0];
  const resized=await resizeImage(file,1);
  posts.push({
    user:currentUser.name,
    image:resized,
    caption:captionInput.value.trim(),
    memoryDate:memoryDate.value,
    likes:[],
    comments:[]
  });
  captionInput.value='';
  memoryDate.value='';
  imageUpload.value='';
  savePosts();
  renderPosts();
};

// Save posts
function savePosts(){localStorage.setItem('posts',JSON.stringify(posts));}

// Resize image
function resizeImage(file,maxMB=1){
  return new Promise((res,rej)=>{
    const img=new Image();
    const fr=new FileReader();
    fr.onload=e=>img.src=e.target.result;
    img.onload=()=>{
      const canvas=document.createElement('canvas');
      let w=img.width,h=img.height;
      const ratio=Math.sqrt((w*h)/(maxMB*1024*1024*4));
      if(ratio>1){w/=ratio;h/=ratio;}
      canvas.width=w;canvas.height=h;
      const ctx=canvas.getContext('2d');
      ctx.drawImage(img,0,0,w,h);
      res(canvas.toDataURL('image/jpeg',0.8));
    };
    fr.onerror=rej;
    fr.readAsDataURL(file);
  });
}
</script>
</body>
</html>
