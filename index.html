<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Lane</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #f8fafc;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --radius: 12px;
        }

        .dark-mode {
            --primary: #818cf8;
            --primary-dark: #6366f1;
            --secondary: #1e293b;
            --text: #f1f5f9;
            --text-light: #94a3b8;
            --border: #334155;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--secondary);
            color: var(--text);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background-color: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .dark-mode header {
            background-color: var(--secondary);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-link {
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .nav-link:hover, .nav-link.active {
            background-color: var(--primary);
            color: white;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
            padding: 30px 0;
        }

        /* Sidebar */
        .sidebar {
            background-color: white;
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            height: fit-content;
            position: sticky;
            top: 90px;
        }

        .dark-mode .sidebar {
            background-color: var(--secondary);
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-section h3 {
            margin-bottom: 15px;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .friend-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .friend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .friend-item:hover {
            background-color: rgba(99, 102, 241, 0.1);
        }

        .friend-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .stat-card {
            background-color: rgba(99, 102, 241, 0.1);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        /* Timeline */
        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .search-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background-color: white;
            color: var(--text);
        }

        .dark-mode .search-input {
            background-color: var(--secondary);
        }

        .filter-select {
            padding: 10px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background-color: white;
            color: var(--text);
        }

        .dark-mode .filter-select {
            background-color: var(--secondary);
        }

        .memories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .memory-card {
            background-color: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }

        .dark-mode .memory-card {
            background-color: var(--secondary);
        }

        .memory-card:hover {
            transform: translateY(-5px);
        }

        .memory-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .memory-content {
            padding: 15px;
        }

        .memory-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .memory-text {
            margin-bottom: 15px;
        }

        .memory-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .reactions {
            display: flex;
            gap: 10px;
        }

        .reaction-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px;
            border-radius: 50%;
            transition: background-color 0.2s;
        }

        .reaction-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .dark-mode .reaction-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-light);
            transition: color 0.2s;
        }

        .action-btn:hover {
            color: var(--primary);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background-color: white;
            border-radius: var(--radius);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .dark-mode .modal-content {
            background-color: var(--secondary);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background-color: white;
            color: var(--text);
            font-family: inherit;
        }

        .dark-mode .form-input, .dark-mode .form-textarea, .dark-mode .form-select {
            background-color: var(--secondary);
        }

        .form-textarea {
            height: 100px;
            resize: vertical;
        }

        .image-preview {
            width: 100%;
            height: 200px;
            background-color: #f1f5f9;
            border-radius: 8px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .dark-mode .image-preview {
            background-color: #334155;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .friends-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .friend-tag {
            background-color: rgba(99, 102, 241, 0.1);
            color: var(--primary);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .friend-tag.selected {
            background-color: var(--primary);
            color: white;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--border);
            color: var(--text);
        }

        .btn-secondary:hover {
            background-color: #d1d5db;
        }

        .dark-mode .btn-secondary {
            background-color: #475569;
            color: var(--text);
        }

        .dark-mode .btn-secondary:hover {
            background-color: #64748b;
        }

        /* Map */
        #memoryMap {
            height: 300px;
            border-radius: var(--radius);
            margin-top: 10px;
        }

        /* Comments */
        .comments-section {
            margin-top: 20px;
            border-top: 1px solid var(--border);
            padding-top: 15px;
        }

        .comment {
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
        }

        .comment:last-child {
            border-bottom: none;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .comment-author {
            font-weight: 500;
        }

        .comment-date {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .add-comment {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .comment-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid var(--border);
            border-radius: 20px;
            background-color: white;
            color: var(--text);
        }

        .dark-mode .comment-input {
            background-color: var(--secondary);
        }

        /* Add Memory Button */
        .add-memory-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 90;
            transition: background-color 0.2s;
        }

        .add-memory-btn:hover {
            background-color: var(--primary-dark);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        /* Toggle */
        .toggle {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
            }
            
            .memories-grid {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span>🕒</span>
                    <span>Memory Lane</span>
                </div>
                <div class="nav-links">
                    <div class="nav-link active" data-view="timeline">Timeline</div>
                    <div class="nav-link" data-view="map">Memory Map</div>
                    <div class="nav-link" data-view="albums">Albums</div>
                    <div class="nav-link" data-view="stats">Statistics</div>
                    <div class="nav-link" data-view="on-this-day">On This Day</div>
                </div>
                <div class="header-actions">
                    <label class="toggle">
                        <input type="checkbox" id="darkModeToggle">
                        <span class="slider"></span>
                    </label>
                    <span>Dark Mode</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <h3>Friends (10)</h3>
                    <div class="friend-list" id="friendList">
                        <!-- Friends will be populated by JavaScript -->
                    </div>
                </div>
                <div class="sidebar-section">
                    <h3>Quick Stats</h3>
                    <div class="stats-grid" id="quickStats">
                        <!-- Stats will be populated by JavaScript -->
                    </div>
                </div>
                <div class="sidebar-section">
                    <h3>Upcoming Birthdays</h3>
                    <div id="upcomingBirthdays">
                        <!-- Birthdays will be populated by JavaScript -->
                    </div>
                </div>
                <div class="sidebar-section">
                    <button class="btn btn-primary" style="width: 100%;" onclick="exportMemories()">Export Memories</button>
                </div>
            </div>

            <!-- Timeline View (Default) -->
            <div class="timeline-view view active">
                <div class="timeline-header">
                    <h2>Memory Timeline</h2>
                    <div>
                        <button class="btn btn-primary" onclick="showMemoryModal()">Add Memory</button>
                    </div>
                </div>
                <div class="search-bar">
                    <input type="text" class="search-input" id="searchInput" placeholder="Search memories...">
                    <select class="filter-select" id="filterAuthor">
                        <option value="">All Friends</option>
                        <!-- Options will be populated by JavaScript -->
                    </select>
                    <select class="filter-select" id="filterDate">
                        <option value="">All Time</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                        <option value="year">This Year</option>
                    </select>
                </div>
                <div class="memories-grid" id="memoriesGrid">
                    <!-- Memories will be populated by JavaScript -->
                </div>
            </div>

            <!-- Map View -->
            <div class="map-view view">
                <div class="timeline-header">
                    <h2>Memory Map</h2>
                </div>
                <div id="memoryMap"></div>
            </div>

            <!-- Albums View -->
            <div class="albums-view view">
                <div class="timeline-header">
                    <h2>Memory Albums</h2>
                    <div>
                        <button class="btn btn-primary" onclick="showAlbumModal()">Create Album</button>
                    </div>
                </div>
                <div class="memories-grid" id="albumsGrid">
                    <!-- Albums will be populated by JavaScript -->
                </div>
            </div>

            <!-- Statistics View -->
            <div class="stats-view view">
                <div class="timeline-header">
                    <h2>Memory Statistics</h2>
                </div>
                <div id="statsContent">
                    <!-- Statistics will be populated by JavaScript -->
                </div>
            </div>

            <!-- On This Day View -->
            <div class="on-this-day-view view">
                <div class="timeline-header">
                    <h2>On This Day</h2>
                </div>
                <div id="onThisDayContent">
                    <!-- On This Day memories will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add Memory Button -->
    <div class="add-memory-btn" onclick="showMemoryModal()">
        +
    </div>

    <!-- Add Memory Modal -->
    <div class="modal" id="memoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add a Memory</h2>
                <button class="action-btn" onclick="closeMemoryModal()">✕</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Upload Photo</label>
                    <input type="file" class="form-input" id="memoryImage" accept="image/*">
                    <div class="image-preview" id="imagePreview">
                        <span>No image selected</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Memory Description</label>
                    <textarea class="form-textarea" id="memoryText" placeholder="Describe this memory..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Location</label>
                    <input type="text" class="form-input" id="memoryLocation" placeholder="Where was this memory made?">
                </div>
                <div class="form-group">
                    <label class="form-label">Who posted this?</label>
                    <select class="form-select" id="memoryAuthor">
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Tag Friends</label>
                    <div class="friends-tags" id="friendsTags">
                        <!-- Friend tags will be populated by JavaScript -->
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Set Reminder</label>
                    <input type="date" class="form-input" id="memoryReminder">
                </div>
                <div class="form-group">
                    <label class="form-label">Add to Album</label>
                    <select class="form-select" id="memoryAlbum">
                        <option value="">No Album</option>
                        <!-- Album options will be populated by JavaScript -->
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeMemoryModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveMemory()">Save Memory</button>
            </div>
        </div>
    </div>

    <!-- View Memory Modal -->
    <div class="modal" id="viewMemoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="viewMemoryTitle">Memory</h2>
                <button class="action-btn" onclick="closeViewMemoryModal()">✕</button>
            </div>
            <div class="modal-body">
                <img id="viewMemoryImage" src="" alt="Memory" class="memory-image">
                <div class="memory-meta">
                    <span id="viewMemoryDate"></span>
                    <span id="viewMemoryAuthor"></span>
                </div>
                <div class="memory-text" id="viewMemoryText"></div>
                <div class="memory-actions">
                    <div class="reactions" id="viewMemoryReactions">
                        <!-- Reactions will be populated by JavaScript -->
                    </div>
                    <div class="action-buttons">
                        <button class="action-btn" onclick="shareMemory(currentViewingMemory)">📤</button>
                        <button class="action-btn" onclick="downloadMemory(currentViewingMemory)">💾</button>
                        <button class="action-btn" onclick="setReminder(currentViewingMemory)">⏰</button>
                    </div>
                </div>
                <div class="comments-section" id="commentsSection">
                    <!-- Comments will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add Album Modal -->
    <div class="modal" id="albumModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create Album</h2>
                <button class="action-btn" onclick="closeAlbumModal()">✕</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Album Name</label>
                    <input type="text" class="form-input" id="albumName" placeholder="Enter album name">
                </div>
                <div class="form-group">
                    <label class="form-label">Album Description</label>
                    <textarea class="form-textarea" id="albumDescription" placeholder="Describe this album..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Cover Photo</label>
                    <input type="file" class="form-input" id="albumCover" accept="image/*">
                    <div class="image-preview" id="albumCoverPreview">
                        <span>No image selected</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAlbumModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveAlbum()">Create Album</button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Data initialization
       <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // Data initialization
   <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // Data initialization
    const friends = [
        { id: 1, name: 'Shifa', avatar: 'S', color: '#6366f1' },
        { id: 2, name: 'Ayaan', avatar: 'A', color: '#ef4444' },
        { id: 3, name: 'Ritika', avatar: 'R', color: '#10b981' },
        { id: 4, name: 'Vidhi', avatar: 'V', color: '#f59e0b' },
        { id: 5, name: 'Saksham', avatar: 'SK', color: '#8b5cf6' },
        { id: 6, name: 'Sai', avatar: 'SI', color: '#06b6d4' },
        { id: 7, name: 'Kunal', avatar: 'K', color: '#f97316' },
        { id: 8, name: 'Juili', avatar: 'J', color: '#ec4899' },
        { id: 9, name: 'Harshit', avatar: 'H', color: '#84cc16' },
        { id: 10, name: 'Palak', avatar: 'P', color: '#f43f5e' },
        { id: 11, name: 'Amrut', avatar: 'A', color: '#0ea5e9' }
    ];

    const friendBirthdays = {
        2: '2008-01-16',
        3: '2008-07-06',
        4: '2008-11-12',
        5: '2009-01-23',
        6: '2008-03-04',
        7: '2008-10-19',
        8: '2008-05-25',
        9: '2007-01-24',
        10: '2007-11-06',
        11: '2005-09-20'
    };

    let memories = JSON.parse(localStorage.getItem('memories')) || [];
    let albums = JSON.parse(localStorage.getItem('albums')) || [];
    let currentViewingMemory = null;
    let map = null;

    // Initialize the application
    function init() {
        // Set up dark mode toggle
        const darkModeToggle = document.getElementById('darkModeToggle');
        const isDarkMode = localStorage.getItem('darkMode') === 'true';
        darkModeToggle.checked = isDarkMode;
        document.body.classList.toggle('dark-mode', isDarkMode);
        
        darkModeToggle.addEventListener('change', function() {
            document.body.classList.toggle('dark-mode', this.checked);
            localStorage.setItem('darkMode', this.checked);
        });

        // Set up navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function() {
                const view = this.getAttribute('data-view');
                showView(view);
                
                // Update active nav link
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Initialize friend list
        renderFriendList();
        
        // Initialize author filter
        renderAuthorFilter();
        
        // Initialize memories
        renderMemories();
        
        // Initialize albums
        renderAlbums();
        
        // Initialize stats
        renderStats();
        
        // Initialize on this day
        renderOnThisDay();
        
        // Initialize map if needed
        if (document.getElementById('memoryMap')) {
            initMap();
        }
        
        // Set up search and filter events
        document.getElementById('searchInput').addEventListener('input', renderMemories);
        document.getElementById('filterAuthor').addEventListener('change', renderMemories);
        document.getElementById('filterDate').addEventListener('change', renderMemories);
        
        // Set up image preview for memory modal
        document.getElementById('memoryImage').addEventListener('change', function(e) {
            previewImage(e, 'imagePreview');
        });
        
        // Set up image preview for album modal
        document.getElementById('albumCover').addEventListener('change', function(e) {
            previewImage(e, 'albumCoverPreview');
        });
        
        // No sample data - start with empty memories
    }

    // Show a specific view
    function showView(viewName) {
        document.querySelectorAll('.view').forEach(view => {
            view.classList.remove('active');
        });
        
        document.querySelector(`.${viewName}-view`).classList.add('active');
        
        // Initialize map if showing map view
        if (viewName === 'map' && !map) {
            setTimeout(initMap, 100);
        }
    }

    // Render friend list in sidebar
    function renderFriendList() {
        const friendList = document.getElementById('friendList');
        friendList.innerHTML = '';
        
        friends.forEach(friend => {
            const friendItem = document.createElement('div');
            friendItem.className = 'friend-item';
            friendItem.innerHTML = `
                <div class="friend-avatar" style="background-color: ${friend.color}">${friend.avatar}</div>
                <span>${friend.name}</span>
            `;
            friendItem.addEventListener('click', () => {
                document.getElementById('filterAuthor').value = friend.name;
                renderMemories();
            });
            friendList.appendChild(friendItem);
        });
    }

    // Render author filter dropdown
    function renderAuthorFilter() {
        const filterAuthor = document.getElementById('filterAuthor');
        const memoryAuthor = document.getElementById('memoryAuthor');
        
        // Clear existing options except the first one
        while (filterAuthor.children.length > 1) {
            filterAuthor.removeChild(filterAuthor.lastChild);
        }
        while (memoryAuthor.children.length > 0) {
            memoryAuthor.removeChild(memoryAuthor.lastChild);
        }
        
        // Add friend options
        friends.forEach(friend => {
            const option1 = document.createElement('option');
            option1.value = friend.name;
            option1.textContent = friend.name;
            filterAuthor.appendChild(option1);
            
            const option2 = document.createElement('option');
            option2.value = friend.name;
            option2.textContent = friend.name;
            memoryAuthor.appendChild(option2);
        });
    }

    // Render memories in the timeline
    function renderMemories() {
        const memoriesGrid = document.getElementById('memoriesGrid');
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const authorFilter = document.getElementById('filterAuthor').value;
        const dateFilter = document.getElementById('filterDate').value;
        
        // Filter memories
        let filteredMemories = memories.filter(memory => {
            // Search filter
            if (searchTerm && !memory.text.toLowerCase().includes(searchTerm) && 
                !memory.location.toLowerCase().includes(searchTerm)) {
                return false;
            }
            
            // Author filter
            if (authorFilter && memory.author !== authorFilter) {
                return false;
            }
            
            // Date filter
            if (dateFilter) {
                const memoryDate = new Date(memory.timestamp);
                const now = new Date();
                
                if (dateFilter === 'week') {
                    const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                    if (memoryDate < weekAgo) return false;
                } else if (dateFilter === 'month') {
                    const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                    if (memoryDate < monthAgo) return false;
                } else if (dateFilter === 'year') {
                    const yearAgo = new Date(now.getTime() - 365 * 24 * 60 * 60 * 1000);
                    if (memoryDate < yearAgo) return false;
                }
            }
            
            return true;
        });
        
        // Sort by date (newest first)
        filteredMemories.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        
        // Render memories
        if (filteredMemories.length === 0) {
            memoriesGrid.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">📭</div>
                    <h3>No memories found</h3>
                    <p>Try changing your search or filters, or add a new memory!</p>
                </div>
            `;
            return;
        }
        
        memoriesGrid.innerHTML = '';
        filteredMemories.forEach(memory => {
            const memoryCard = document.createElement('div');
            memoryCard.className = 'memory-card';
            memoryCard.innerHTML = `
                <img src="${memory.image}" alt="Memory" class="memory-image">
                <div class="memory-content">
                    <div class="memory-meta">
                        <span>${formatDate(memory.timestamp)}</span>
                        <span>${memory.author}</span>
                    </div>
                    <div class="memory-text">${memory.text}</div>
                    <div class="memory-actions">
                        <div class="reactions">
                            <button class="reaction-btn" onclick="reactToMemory(${memory.id}, '❤️')">❤️ ${memory.reactions['❤️'] || 0}</button>
                            <button class="reaction-btn" onclick="reactToMemory(${memory.id}, '😂')">😂 ${memory.reactions['😂'] || 0}</button>
                            <button class="reaction-btn" onclick="reactToMemory(${memory.id}, '🔥')">🔥 ${memory.reactions['🔥'] || 0}</button>
                        </div>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="viewMemory(${memory.id})">👁️</button>
                            <button class="action-btn" onclick="shareMemory(${memory.id})">📤</button>
                        </div>
                    </div>
                </div>
            `;
            memoriesGrid.appendChild(memoryCard);
        });
        
        // Update quick stats
        updateQuickStats();
    }

    // Render albums
    function renderAlbums() {
        const albumsGrid = document.getElementById('albumsGrid');
        
        if (albums.length === 0) {
            albumsGrid.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">📚</div>
                    <h3>No albums yet</h3>
                    <p>Create your first album to organize memories!</p>
                </div>
            `;
            return;
        }
        
        albumsGrid.innerHTML = '';
        albums.forEach(album => {
            const albumCard = document.createElement('div');
            albumCard.className = 'memory-card';
            albumCard.innerHTML = `
                <img src="${album.cover || 'https://via.placeholder.com/300x200?text=No+Cover'}" alt="${album.name}" class="memory-image">
                <div class="memory-content">
                    <div class="memory-meta">
                        <span>${album.memories.length} memories</span>
                    </div>
                    <div class="memory-text">
                        <h3>${album.name}</h3>
                        <p>${album.description}</p>
                    </div>
                    <div class="memory-actions">
                        <button class="btn btn-primary" onclick="viewAlbum(${album.id})">View Album</button>
                    </div>
                </div>
            `;
            albumsGrid.appendChild(albumCard);
        });
    }

    // Render statistics
    function renderStats() {
        const statsContent = document.getElementById('statsContent');
        
        // Calculate stats
        const totalMemories = memories.length;
        const memoriesThisMonth = memories.filter(m => {
            const memoryDate = new Date(m.timestamp);
            const now = new Date();
            return memoryDate.getMonth() === now.getMonth() && 
                   memoryDate.getFullYear() === now.getFullYear();
        }).length;
        
        const mostActiveFriend = getMostActiveFriend();
        const topReaction = getTopReaction();
        
        statsContent.innerHTML = `
            <div class="stats-grid" style="grid-template-columns: repeat(4, 1fr); margin-bottom: 30px;">
                <div class="stat-card">
                    <div class="stat-value">${totalMemories}</div>
                    <div class="stat-label">Total Memories</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${memoriesThisMonth}</div>
                    <div class="stat-label">This Month</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${mostActiveFriend.name}</div>
                    <div class="stat-label">Most Active</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${topReaction.emoji} ${topReaction.count}</div>
                    <div class="stat-label">Top Reaction</div>
                </div>
            </div>
            
            <div class="sidebar-section">
                <h3>Memories by Friend</h3>
                <div id="friendStats">
                    ${renderFriendStats()}
                </div>
            </div>
            
            <div class="sidebar-section">
                <h3>Memories by Month</h3>
                <div id="monthlyStats">
                    ${renderMonthlyStats()}
                </div>
            </div>
        `;
    }

    // Render on this day memories
    function renderOnThisDay() {
        const onThisDayContent = document.getElementById('onThisDayContent');
        const today = new Date();
        const todayMonth = today.getMonth();
        const todayDate = today.getDate();
        
        const onThisDayMemories = memories.filter(memory => {
            const memoryDate = new Date(memory.timestamp);
            return memoryDate.getMonth() === todayMonth && memoryDate.getDate() === todayDate;
        });
        
        if (onThisDayMemories.length === 0) {
            onThisDayContent.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">📅</div>
                    <h3>No memories on this day</h3>
                    <p>Check back tomorrow or add some new memories!</p>
                </div>
            `;
            return;
        }
        
        onThisDayContent.innerHTML = `
            <h3>Memories from ${todayDate} ${getMonthName(todayMonth)}</h3>
            <div class="memories-grid">
                ${onThisDayMemories.map(memory => `
                    <div class="memory-card">
                        <img src="${memory.image}" alt="Memory" class="memory-image">
                        <div class="memory-content">
                            <div class="memory-meta">
                                <span>${new Date(memory.timestamp).getFullYear()}</span>
                                <span>${memory.author}</span>
                            </div>
                            <div class="memory-text">${memory.text}</div>
                            <div class="memory-actions">
                                <button class="btn btn-primary" onclick="viewMemory(${memory.id})">View Memory</button>
                            </div>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    }

    // Initialize map
    function initMap() {
        if (map) {
            map.remove();
        }
        
        map = L.map('memoryMap').setView([19.0760, 72.8777], 10); // Mumbai coordinates
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // Add markers for memories with locations
        memories.forEach(memory => {
            if (memory.location && memory.lat && memory.lng) {
                L.marker([memory.lat, memory.lng])
                    .addTo(map)
                    .bindPopup(`
                        <div>
                            <img src="${memory.image}" style="width: 100px; height: 100px; object-fit: cover;">
                            <p><strong>${memory.author}</strong></p>
                            <p>${memory.text}</p>
                            <p><small>${formatDate(memory.timestamp)}</small></p>
                        </div>
                    `);
            }
        });
    }

    // Show memory modal
    function showMemoryModal() {
        // Reset form
        document.getElementById('memoryImage').value = '';
        document.getElementById('memoryText').value = '';
        document.getElementById('memoryLocation').value = '';
        document.getElementById('memoryAuthor').value = 'Shifa';
        document.getElementById('memoryReminder').value = '';
        document.getElementById('memoryAlbum').value = '';
        document.getElementById('imagePreview').innerHTML = '<span>No image selected</span>';
        
        // Render friend tags
        renderFriendTags();
        
        // Render album options
        renderAlbumOptions();
        
        // Show modal
        document.getElementById('memoryModal').style.display = 'flex';
    }

    // Close memory modal
    function closeMemoryModal() {
        document.getElementById('memoryModal').style.display = 'none';
    }

    // Show album modal
    function showAlbumModal() {
        // Reset form
        document.getElementById('albumName').value = '';
        document.getElementById('albumDescription').value = '';
        document.getElementById('albumCover').value = '';
        document.getElementById('albumCoverPreview').innerHTML = '<span>No image selected</span>';
        
        // Show modal
        document.getElementById('albumModal').style.display = 'flex';
    }

    // Close album modal
    function closeAlbumModal() {
        document.getElementById('albumModal').style.display = 'none';
    }

    // Preview image before upload
    function previewImage(event, previewElementId) {
        const file = event.target.files[0];
        const preview = document.getElementById(previewElementId);
        
        if (file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
            }
            
            reader.readAsDataURL(file);
        } else {
            preview.innerHTML = '<span>No image selected</span>';
        }
    }

    // Render friend tags for memory modal
    function renderFriendTags() {
        const friendsTags = document.getElementById('friendsTags');
        friendsTags.innerHTML = '';
        
        friends.forEach(friend => {
            if (friend.name === 'Shifa') return; // Skip yourself
            
            const friendTag = document.createElement('div');
            friendTag.className = 'friend-tag';
            friendTag.textContent = friend.name;
            friendTag.addEventListener('click', function() {
                this.classList.toggle('selected');
            });
            friendsTags.appendChild(friendTag);
        });
    }

    // Render album options for memory modal
    function renderAlbumOptions() {
        const memoryAlbum = document.getElementById('memoryAlbum');
        
        // Clear existing options except the first one
        while (memoryAlbum.children.length > 1) {
            memoryAlbum.removeChild(memoryAlbum.lastChild);
        }
        
        // Add album options
        albums.forEach(album => {
            const option = document.createElement('option');
            option.value = album.id;
            option.textContent = album.name;
            memoryAlbum.appendChild(option);
        });
    }

    // Save a new memory
    function saveMemory() {
        const imageFile = document.getElementById('memoryImage').files[0];
        const text = document.getElementById('memoryText').value.trim();
        const location = document.getElementById('memoryLocation').value.trim();
        const author = document.getElementById('memoryAuthor').value;
        const reminder = document.getElementById('memoryReminder').value;
        const albumId = document.getElementById('memoryAlbum').value;
        
        if (!imageFile) {
            alert('Please upload a photo!');
            return;
        }
        
        if (!text) {
            alert('Please describe your memory!');
            return;
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
            const memory = {
                id: Date.now(),
                image: e.target.result,
                text: text,
                location: location,
                author: author,
                timestamp: new Date().toISOString(),
                reactions: { '❤️': 0, '😂': 0, '🔥': 0 },
                comments: [],
                taggedFriends: getSelectedFriends(),
                reminder: reminder || null,
                albumId: albumId || null
            };
            
            // If location is provided, try to geocode it (simplified for demo)
            if (location) {
                // In a real app, you would use a geocoding service here
                // For demo, we'll just set some random coordinates near Mumbai
                memory.lat = 19.0760 + (Math.random() - 0.5) * 0.1;
                memory.lng = 72.8777 + (Math.random() - 0.5) * 0.1;
            }
            
            memories.unshift(memory);
            localStorage.setItem('memories', JSON.stringify(memories));
            
            // If album is selected, add memory to album
            if (albumId) {
                const album = albums.find(a => a.id == albumId);
                if (album) {
                    album.memories.push(memory.id);
                    localStorage.setItem('albums', JSON.stringify(albums));
                }
            }
            
            // Set reminder if provided
            if (reminder) {
                setMemoryReminder(memory.id, reminder);
            }
            
            closeMemoryModal();
            renderMemories();
            
            // If on map view, update map
            if (map) {
                initMap();
            }
            
            alert('Memory saved successfully!');
        };
        
        reader.readAsDataURL(imageFile);
    }

    // Save a new album
    function saveAlbum() {
        const name = document.getElementById('albumName').value.trim();
        const description = document.getElementById('albumDescription').value.trim();
        const coverFile = document.getElementById('albumCover').files[0];
        
        if (!name) {
            alert('Please enter an album name!');
            return;
        }
        
        let cover = null;
        if (coverFile) {
            const reader = new FileReader();
            reader.onload = function(e) {
                cover = e.target.result;
                completeAlbumSave(name, description, cover);
            };
            reader.readAsDataURL(coverFile);
        } else {
            completeAlbumSave(name, description, cover);
        }
    }

    function completeAlbumSave(name, description, cover) {
        const album = {
            id: Date.now(),
            name: name,
            description: description,
            cover: cover,
            memories: [],
            created: new Date().toISOString()
        };
        
        albums.push(album);
        localStorage.setItem('albums', JSON.stringify(albums));
        
        closeAlbumModal();
        renderAlbums();
        renderAlbumOptions();
        
        alert('Album created successfully!');
    }

    // Get selected friends from tags
    function getSelectedFriends() {
        const selectedTags = document.querySelectorAll('.friend-tag.selected');
        return Array.from(selectedTags).map(tag => tag.textContent);
    }

    // View a memory in detail
    function viewMemory(memoryId) {
        const memory = memories.find(m => m.id === memoryId);
        if (!memory) return;
        
        currentViewingMemory = memoryId;
        
        document.getElementById('viewMemoryTitle').textContent = 'Memory';
        document.getElementById('viewMemoryImage').src = memory.image;
        document.getElementById('viewMemoryDate').textContent = formatDate(memory.timestamp);
        document.getElementById('viewMemoryAuthor').textContent = `by ${memory.author}`;
        document.getElementById('viewMemoryText').textContent = memory.text;
        
        // Render reactions
        const reactionsContainer = document.getElementById('viewMemoryReactions');
        reactionsContainer.innerHTML = '';
        
        Object.entries(memory.reactions).forEach(([emoji, count]) => {
            if (count > 0) {
                const reactionBtn = document.createElement('button');
                reactionBtn.className = 'reaction-btn';
                reactionBtn.textContent = `${emoji} ${count}`;
                reactionBtn.onclick = () => reactToMemory(memoryId, emoji);
                reactionsContainer.appendChild(reactionBtn);
            }
        });
        
        // Add reaction buttons
        ['❤️', '😂', '🔥'].forEach(emoji => {
            if (!memory.reactions[emoji] || memory.reactions[emoji] === 0) {
                const reactionBtn = document.createElement('button');
                reactionBtn.className = 'reaction-btn';
                reactionBtn.textContent = emoji;
                reactionBtn.onclick = () => reactToMemory(memoryId, emoji);
                reactionsContainer.appendChild(reactionBtn);
            }
        });
        
        // Render comments
        renderComments(memory);
        
        // Show modal
        document.getElementById('viewMemoryModal').style.display = 'flex';
    }

    // Close view memory modal
    function closeViewMemoryModal() {
        document.getElementById('viewMemoryModal').style.display = 'none';
        currentViewingMemory = null;
    }

    // Render comments for a memory
    function renderComments(memory) {
        const commentsSection = document.getElementById('commentsSection');
        
        commentsSection.innerHTML = `
            <h3>Comments (${memory.comments.length})</h3>
            ${memory.comments.map(comment => `
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">${comment.author}</span>
                        <span class="comment-date">${formatDate(comment.timestamp)}</span>
                    </div>
                    <div class="comment-text">${comment.text}</div>
                </div>
            `).join('')}
            <div class="add-comment">
                <input type="text" class="comment-input" id="newComment" placeholder="Add a comment...">
                <button class="btn btn-primary" onclick="addComment(${memory.id})">Post</button>
            </div>
        `;
    }

    // Add a comment to a memory
    function addComment(memoryId) {
        const commentInput = document.getElementById('newComment');
        const text = commentInput.value.trim();
        
        if (!text) return;
        
        const memory = memories.find(m => m.id === memoryId);
        if (!memory) return;
        
        memory.comments.push({
            author: 'Shifa', // In a real app, this would be the current user
            text: text,
            timestamp: new Date().toISOString()
        });
        
        localStorage.setItem('memories', JSON.stringify(memories));
        renderComments(memory);
        commentInput.value = '';
    }

    // React to a memory
    function reactToMemory(memoryId, emoji) {
        const memory = memories.find(m => m.id === memoryId);
        if (!memory) return;
        
        if (!memory.reactions[emoji]) {
            memory.reactions[emoji] = 0;
        }
        
        memory.reactions[emoji]++;
        localStorage.setItem('memories', JSON.stringify(memories));
        
        // If we're viewing the memory, update the view
        if (currentViewingMemory === memoryId) {
            viewMemory(memoryId);
        } else {
            renderMemories();
        }
    }

    // Share a memory
    function shareMemory(memoryId) {
        const memory = memories.find(m => m.id === memoryId);
        if (!memory) return;
        
        const text = `Check out this memory from Memory Lane: "${memory.text}"`;
        const url = window.location.href;
        
        if (navigator.share) {
            navigator.share({
                title: 'Memory Lane',
                text: text,
                url: url
            });
        } else {
            // Fallback for browsers that don't support Web Share API
            navigator.clipboard.writeText(text + ' ' + url).then(() => {
                alert('Memory link copied to clipboard!');
            });
        }
    }

    // Download a memory
    function downloadMemory(memoryId) {
        const memory = memories.find(m => m.id === memoryId);
        if (!memory) return;
        
        const link = document.createElement('a');
        link.href = memory.image;
        link.download = `memory-${memoryId}.jpg`;
        link.click();
    }

    // Set a reminder for a memory
    function setReminder(memoryId) {
        const date = prompt('Enter reminder date (YYYY-MM-DD):');
        if (!date) return;
        
        setMemoryReminder(memoryId, date);
        alert('Reminder set!');
    }

    // Set memory reminder (simplified for demo)
    function setMemoryReminder(memoryId, date) {
        // In a real app, you would use the Notifications API or a service worker
        // For this demo, we'll just store it and show an alert
        const memory = memories.find(m => m.id === memoryId);
        if (!memory) return;
        
        memory.reminder = date;
        localStorage.setItem('memories', JSON.stringify(memories));
        
        // Schedule a simple alert (in a real app, you'd use more robust scheduling)
        const reminderTime = new Date(date).getTime() - Date.now();
        if (reminderTime > 0) {
            setTimeout(() => {
                alert(`Reminder: ${memory.text}`);
            }, Math.min(reminderTime, 2147483647)); // Max setTimeout value
        }
    }

    // View an album
    function viewAlbum(albumId) {
        const album = albums.find(a => a.id === albumId);
        if (!album) return;
        
        const albumMemories = memories.filter(m => album.memories.includes(m.id));
        
        // For this demo, we'll just show an alert with the album info
        // In a real app, you would create a proper album view
        alert(`Album: ${album.name}\nMemories: ${albumMemories.length}\n\nClick OK to view these memories in the timeline.`);
        
        // Filter timeline to show only album memories
        document.getElementById('searchInput').value = '';
        document.getElementById('filterAuthor').value = '';
        document.getElementById('filterDate').value = '';
        
        // We can't directly filter by album in the current implementation,
        // so we'll just switch to the timeline view
        showView('timeline');
    }

    // Export memories
    function exportMemories() {
        const dataStr = JSON.stringify(memories, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        
        const link = document.createElement('a');
        link.href = URL.createObjectURL(dataBlob);
        link.download = 'memory-lane-export.json';
        link.click();
    }

    // Update quick stats in sidebar
    function updateQuickStats() {
        const quickStats = document.getElementById('quickStats');
        const totalMemories = memories.length;
        
        const memoriesThisWeek = memories.filter(m => {
            const memoryDate = new Date(m.timestamp);
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
            return memoryDate > weekAgo;
        }).length;
        
        const memoriesWithReactions = memories.filter(m => 
            Object.values(m.reactions).some(count => count > 0)
        ).length;
        
        quickStats.innerHTML = `
            <div class="stat-card">
                <div class="stat-value">${totalMemories}</div>
                <div class="stat-label">Total</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${memoriesThisWeek}</div>
                <div class="stat-label">This Week</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${memoriesWithReactions}</div>
                <div class="stat-label">With Reactions</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${friends.length}</div>
                <div class="stat-label">Friends</div>
            </div>
        `;
        
        // Update upcoming birthdays
        updateUpcomingBirthdays();
    }

    // Update upcoming birthdays in sidebar
    function updateUpcomingBirthdays() {
        const upcomingBirthdays = document.getElementById('upcomingBirthdays');
        const today = new Date();
        const nextMonth = new Date(today.getFullYear(), today.getMonth() + 1, today.getDate());
        
        const upcoming = [];
        
        Object.entries(friendBirthdays).forEach(([friendId, birthday]) => {
            const birthdayDate = new Date(birthday);
            birthdayDate.setFullYear(today.getFullYear()); // Set to current year
            
            if (birthdayDate >= today && birthdayDate <= nextMonth) {
                const friend = friends.find(f => f.id == friendId);
                if (friend) {
                    upcoming.push({
                        friend: friend,
                        date: birthdayDate
                    });
                }
            }
        });
        
        // Sort by date
        upcoming.sort((a, b) => a.date - b.date);
        
        if (upcoming.length === 0) {
            upcomingBirthdays.innerHTML = '<p>No upcoming birthdays</p>';
            return;
        }
        
        upcomingBirthdays.innerHTML = upcoming.map(item => `
            <div class="friend-item">
                <div class="friend-avatar" style="background-color: ${item.friend.color}">${item.friend.avatar}</div>
                <div>
                    <div>${item.friend.name}</div>
                    <div style="font-size: 0.8rem; color: var(--text-light);">
                        ${formatDate(item.date.toISOString())}
                    </div>
                </div>
            </div>
        `).join('');
    }

    // Get most active friend
    function getMostActiveFriend() {
        const friendCounts = {};
        
        memories.forEach(memory => {
            if (!friendCounts[memory.author]) {
                friendCounts[memory.author] = 0;
            }
            friendCounts[memory.author]++;
        });
        
        let mostActive = { name: 'No one', count: 0 };
        Object.entries(friendCounts).forEach(([name, count]) => {
            if (count > mostActive.count) {
                mostActive = { name, count };
            }
        });
        
        return mostActive;
    }

    // Get top reaction
    function getTopReaction() {
        const reactionCounts = { '❤️': 0, '😂': 0, '🔥': 0 };
        
        memories.forEach(memory => {
            Object.entries(memory.reactions).forEach(([emoji, count]) => {
                if (reactionCounts[emoji] !== undefined) {
                    reactionCounts[emoji] += count;
                }
            });
        });
        
        let topReaction = { emoji: '❤️', count: 0 };
        Object.entries(reactionCounts).forEach(([emoji, count]) => {
            if (count > topReaction.count) {
                topReaction = { emoji, count };
            }
        });
        
        return topReaction;
    }

    // Render friend stats
    function renderFriendStats() {
        const friendCounts = {};
        
        friends.forEach(friend => {
            friendCounts[friend.name] = 0;
        });
        
        memories.forEach(memory => {
            if (friendCounts[memory.author] !== undefined) {
                friendCounts[memory.author]++;
            }
        });
        
        return Object.entries(friendCounts).map(([name, count]) => `
            <div class="friend-item">
                <div class="friend-avatar" style="background-color: ${friends.find(f => f.name === name).color}">
                    ${friends.find(f => f.name === name).avatar}
                </div>
                <div style="flex: 1;">
                    <div>${name}</div>
                    <div style="font-size: 0.8rem; color: var(--text-light);">
                        ${count} memory${count !== 1 ? 'ies' : 'y'}
                    </div>
                </div>
            </div>
        `).join('');
    }

    // Render monthly stats
    function renderMonthlyStats() {
        const monthlyCounts = {};
        
        memories.forEach(memory => {
            const date = new Date(memory.timestamp);
            const monthYear = `${date.getFullYear()}-${date.getMonth()}`;
            
            if (!monthlyCounts[monthYear]) {
                monthlyCounts[monthYear] = 0;
            }
            monthlyCounts[monthYear]++;
        });
        
        // Get last 6 months
        const last6Months = [];
        const today = new Date();
        
        for (let i = 0; i < 6; i++) {
            const date = new Date(today.getFullYear(), today.getMonth() - i, 1);
            const monthYear = `${date.getFullYear()}-${date.getMonth()}`;
            last6Months.unshift({
                label: `${getMonthName(date.getMonth())} ${date.getFullYear()}`,
                count: monthlyCounts[monthYear] || 0
            });
        }
        
        return last6Months.map(month => `
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                <span>${month.label}</span>
                <span>${month.count}</span>
            </div>
        `).join('');
    }

    // Utility function to format date
    function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric'
        });
    }

    // Utility function to get month name
    function getMonthName(monthIndex) {
        const months = [
            'January', 'February', 'March', 'April', 'May', 'June',
            'July', 'August', 'September', 'October', 'November', 'December'
        ];
        return months[monthIndex];
    }

    // Initialize the app when the page loads
    window.addEventListener('DOMContentLoaded', init);
</script>

    
      

</body>
</html>
           
      
            
       
